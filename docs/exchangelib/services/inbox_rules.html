<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>exchangelib.services.inbox_rules API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>exchangelib.services.inbox_rules</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">from typing import Any, Generator, Optional, Union

from ..errors import ErrorInvalidOperation
from ..properties import CreateRuleOperation, DeleteRuleOperation, InboxRules, Operations, Rule, SetRuleOperation
from ..util import MNS, add_xml_child, create_element, get_xml_attr, set_xml_value
from ..version import EXCHANGE_2010
from .common import EWSAccountService


class GetInboxRules(EWSAccountService):
    &#34;&#34;&#34;
    MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getinboxrules-operation

    The GetInboxRules operation uses Exchange Web Services to retrieve Inbox rules in the identified user&#39;s mailbox.
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;GetInboxRules&#34;
    supported_from = EXCHANGE_2010
    element_container_name = InboxRules.response_tag()
    ERRORS_TO_CATCH_IN_RESPONSE = EWSAccountService.ERRORS_TO_CATCH_IN_RESPONSE + (ErrorInvalidOperation,)

    def call(self, mailbox: Optional[str] = None) -&gt; Generator[Union[Rule, Exception, None], Any, None]:
        if not mailbox:
            mailbox = self.account.primary_smtp_address
        payload = self.get_payload(mailbox=mailbox)
        elements = self._get_elements(payload=payload)
        return self._elems_to_objs(elements)

    def _elem_to_obj(self, elem):
        return Rule.from_xml(elem=elem, account=self.account)

    def get_payload(self, mailbox):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        add_xml_child(payload, &#34;m:MailboxSmtpAddress&#34;, mailbox)
        return payload

    def _get_element_container(self, message, name=None):
        if name:
            response_class = message.get(&#34;ResponseClass&#34;)
            response_code = get_xml_attr(message, f&#34;{{{MNS}}}ResponseCode&#34;)
            if response_class == &#34;Success&#34; and response_code == &#34;NoError&#34; and message.find(name) is None:
                return []
        return super()._get_element_container(message, name)


class UpdateInboxRules(EWSAccountService):
    &#34;&#34;&#34;
    MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation

    The UpdateInboxRules operation updates the authenticated user&#39;s Inbox rules by applying the specified operations.
    UpdateInboxRules is used to create an Inbox rule, to set an Inbox rule, or to delete an Inbox rule.

    When you use the UpdateInboxRules operation, Exchange Web Services deletes client-side send rules.
    Client-side send rules are stored on the client in the rule Folder Associated Information (FAI) Message and nowhere
    else. EWS deletes this rule FAI message by default, based on the expectation that Outlook will recreate it.
    However, Outlook can&#39;t recreate rules that don&#39;t also exist as an extended rule, and client-side send rules don&#39;t
    exist as extended rules. As a result, these rules are lost. We suggest you consider this when designing your
    solution.
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;UpdateInboxRules&#34;
    supported_from = EXCHANGE_2010
    ERRORS_TO_CATCH_IN_RESPONSE = EWSAccountService.ERRORS_TO_CATCH_IN_RESPONSE + (ErrorInvalidOperation,)


class CreateInboxRule(UpdateInboxRules):
    &#34;&#34;&#34;
    MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation#updateinboxrules-create-rule-request-example
    &#34;&#34;&#34;

    def call(self, rule: Rule, remove_outlook_rule_blob: bool = True):
        payload = self.get_payload(rule=rule, remove_outlook_rule_blob=remove_outlook_rule_blob)
        return self._get_elements(payload=payload)

    def get_payload(self, rule: Rule, remove_outlook_rule_blob: bool = True):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        add_xml_child(payload, &#34;m:RemoveOutlookRuleBlob&#34;, remove_outlook_rule_blob)
        operations = Operations(create_rule_operation=CreateRuleOperation(rule=rule))
        set_xml_value(payload, operations, version=self.account.version)
        return payload


class SetInboxRule(UpdateInboxRules):
    &#34;&#34;&#34;
    MSDN:
    https://learn.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation#updateinboxrules-set-rule-request-example
    &#34;&#34;&#34;

    def call(self, rule: Rule, remove_outlook_rule_blob: bool = True):
        payload = self.get_payload(rule=rule, remove_outlook_rule_blob=remove_outlook_rule_blob)
        return self._get_elements(payload=payload)

    def get_payload(self, rule: Rule, remove_outlook_rule_blob: bool = True):
        if not rule.id:
            raise ValueError(&#34;Rule must have an ID&#34;)
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        add_xml_child(payload, &#34;m:RemoveOutlookRuleBlob&#34;, remove_outlook_rule_blob)
        operations = Operations(set_rule_operation=SetRuleOperation(rule=rule))
        set_xml_value(payload, operations, version=self.account.version)
        return payload


class DeleteInboxRule(UpdateInboxRules):
    &#34;&#34;&#34;
    MSDN:
    https://learn.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation#updateinboxrules-delete-rule-request-example
    &#34;&#34;&#34;

    def call(self, rule: Rule, remove_outlook_rule_blob: bool = True):
        payload = self.get_payload(rule=rule, remove_outlook_rule_blob=remove_outlook_rule_blob)
        return self._get_elements(payload=payload)

    def get_payload(self, rule: Rule, remove_outlook_rule_blob: bool = True):
        if not rule.id:
            raise ValueError(&#34;Rule must have an ID&#34;)
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        add_xml_child(payload, &#34;m:RemoveOutlookRuleBlob&#34;, remove_outlook_rule_blob)
        operations = Operations(delete_rule_operation=DeleteRuleOperation(id=rule.id))
        set_xml_value(payload, operations, version=self.account.version)
        return payload</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="exchangelib.services.inbox_rules.CreateInboxRule"><code class="flex name class">
<span>class <span class="ident">CreateInboxRule</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation#updateinboxrules-create-rule-request-example">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation#updateinboxrules-create-rule-request-example</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class CreateInboxRule(UpdateInboxRules):
    &#34;&#34;&#34;
    MSDN:
    https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation#updateinboxrules-create-rule-request-example
    &#34;&#34;&#34;

    def call(self, rule: Rule, remove_outlook_rule_blob: bool = True):
        payload = self.get_payload(rule=rule, remove_outlook_rule_blob=remove_outlook_rule_blob)
        return self._get_elements(payload=payload)

    def get_payload(self, rule: Rule, remove_outlook_rule_blob: bool = True):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        add_xml_child(payload, &#34;m:RemoveOutlookRuleBlob&#34;, remove_outlook_rule_blob)
        operations = Operations(create_rule_operation=CreateRuleOperation(rule=rule))
        set_xml_value(payload, operations, version=self.account.version)
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.inbox_rules.UpdateInboxRules" href="#exchangelib.services.inbox_rules.UpdateInboxRules">UpdateInboxRules</a></li>
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.inbox_rules.CreateInboxRule.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, rule: <a title="exchangelib.properties.Rule" href="../properties.html#exchangelib.properties.Rule">Rule</a>, remove_outlook_rule_blob: bool = True)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, rule: Rule, remove_outlook_rule_blob: bool = True):
    payload = self.get_payload(rule=rule, remove_outlook_rule_blob=remove_outlook_rule_blob)
    return self._get_elements(payload=payload)</code></pre>
</details>
</dd>
<dt id="exchangelib.services.inbox_rules.CreateInboxRule.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, rule: <a title="exchangelib.properties.Rule" href="../properties.html#exchangelib.properties.Rule">Rule</a>, remove_outlook_rule_blob: bool = True)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, rule: Rule, remove_outlook_rule_blob: bool = True):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    add_xml_child(payload, &#34;m:RemoveOutlookRuleBlob&#34;, remove_outlook_rule_blob)
    operations = Operations(create_rule_operation=CreateRuleOperation(rule=rule))
    set_xml_value(payload, operations, version=self.account.version)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.inbox_rules.UpdateInboxRules" href="#exchangelib.services.inbox_rules.UpdateInboxRules">UpdateInboxRules</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.inbox_rules.DeleteInboxRule"><code class="flex name class">
<span>class <span class="ident">DeleteInboxRule</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://learn.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation#updateinboxrules-delete-rule-request-example">https://learn.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation#updateinboxrules-delete-rule-request-example</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DeleteInboxRule(UpdateInboxRules):
    &#34;&#34;&#34;
    MSDN:
    https://learn.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation#updateinboxrules-delete-rule-request-example
    &#34;&#34;&#34;

    def call(self, rule: Rule, remove_outlook_rule_blob: bool = True):
        payload = self.get_payload(rule=rule, remove_outlook_rule_blob=remove_outlook_rule_blob)
        return self._get_elements(payload=payload)

    def get_payload(self, rule: Rule, remove_outlook_rule_blob: bool = True):
        if not rule.id:
            raise ValueError(&#34;Rule must have an ID&#34;)
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        add_xml_child(payload, &#34;m:RemoveOutlookRuleBlob&#34;, remove_outlook_rule_blob)
        operations = Operations(delete_rule_operation=DeleteRuleOperation(id=rule.id))
        set_xml_value(payload, operations, version=self.account.version)
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.inbox_rules.UpdateInboxRules" href="#exchangelib.services.inbox_rules.UpdateInboxRules">UpdateInboxRules</a></li>
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.inbox_rules.DeleteInboxRule.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, rule: <a title="exchangelib.properties.Rule" href="../properties.html#exchangelib.properties.Rule">Rule</a>, remove_outlook_rule_blob: bool = True)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, rule: Rule, remove_outlook_rule_blob: bool = True):
    payload = self.get_payload(rule=rule, remove_outlook_rule_blob=remove_outlook_rule_blob)
    return self._get_elements(payload=payload)</code></pre>
</details>
</dd>
<dt id="exchangelib.services.inbox_rules.DeleteInboxRule.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, rule: <a title="exchangelib.properties.Rule" href="../properties.html#exchangelib.properties.Rule">Rule</a>, remove_outlook_rule_blob: bool = True)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, rule: Rule, remove_outlook_rule_blob: bool = True):
    if not rule.id:
        raise ValueError(&#34;Rule must have an ID&#34;)
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    add_xml_child(payload, &#34;m:RemoveOutlookRuleBlob&#34;, remove_outlook_rule_blob)
    operations = Operations(delete_rule_operation=DeleteRuleOperation(id=rule.id))
    set_xml_value(payload, operations, version=self.account.version)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.inbox_rules.UpdateInboxRules" href="#exchangelib.services.inbox_rules.UpdateInboxRules">UpdateInboxRules</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.inbox_rules.GetInboxRules"><code class="flex name class">
<span>class <span class="ident">GetInboxRules</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getinboxrules-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getinboxrules-operation</a></p>
<p>The GetInboxRules operation uses Exchange Web Services to retrieve Inbox rules in the identified user's mailbox.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GetInboxRules(EWSAccountService):
    &#34;&#34;&#34;
    MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/getinboxrules-operation

    The GetInboxRules operation uses Exchange Web Services to retrieve Inbox rules in the identified user&#39;s mailbox.
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;GetInboxRules&#34;
    supported_from = EXCHANGE_2010
    element_container_name = InboxRules.response_tag()
    ERRORS_TO_CATCH_IN_RESPONSE = EWSAccountService.ERRORS_TO_CATCH_IN_RESPONSE + (ErrorInvalidOperation,)

    def call(self, mailbox: Optional[str] = None) -&gt; Generator[Union[Rule, Exception, None], Any, None]:
        if not mailbox:
            mailbox = self.account.primary_smtp_address
        payload = self.get_payload(mailbox=mailbox)
        elements = self._get_elements(payload=payload)
        return self._elems_to_objs(elements)

    def _elem_to_obj(self, elem):
        return Rule.from_xml(elem=elem, account=self.account)

    def get_payload(self, mailbox):
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        add_xml_child(payload, &#34;m:MailboxSmtpAddress&#34;, mailbox)
        return payload

    def _get_element_container(self, message, name=None):
        if name:
            response_class = message.get(&#34;ResponseClass&#34;)
            response_code = get_xml_attr(message, f&#34;{{{MNS}}}ResponseCode&#34;)
            if response_class == &#34;Success&#34; and response_code == &#34;NoError&#34; and message.find(name) is None:
                return []
        return super()._get_element_container(message, name)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.inbox_rules.GetInboxRules.ERRORS_TO_CATCH_IN_RESPONSE"><code class="name">var <span class="ident">ERRORS_TO_CATCH_IN_RESPONSE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.inbox_rules.GetInboxRules.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.inbox_rules.GetInboxRules.element_container_name"><code class="name">var <span class="ident">element_container_name</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.inbox_rules.GetInboxRules.supported_from"><code class="name">var <span class="ident">supported_from</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.inbox_rules.GetInboxRules.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, mailbox: Optional[str] = None) ‑> Generator[Union[<a title="exchangelib.properties.Rule" href="../properties.html#exchangelib.properties.Rule">Rule</a>, Exception, ForwardRef(None)], Any, None]</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, mailbox: Optional[str] = None) -&gt; Generator[Union[Rule, Exception, None], Any, None]:
    if not mailbox:
        mailbox = self.account.primary_smtp_address
    payload = self.get_payload(mailbox=mailbox)
    elements = self._get_elements(payload=payload)
    return self._elems_to_objs(elements)</code></pre>
</details>
</dd>
<dt id="exchangelib.services.inbox_rules.GetInboxRules.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, mailbox)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, mailbox):
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    add_xml_child(payload, &#34;m:MailboxSmtpAddress&#34;, mailbox)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.inbox_rules.SetInboxRule"><code class="flex name class">
<span>class <span class="ident">SetInboxRule</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN:
<a href="https://learn.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation#updateinboxrules-set-rule-request-example">https://learn.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation#updateinboxrules-set-rule-request-example</a></p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SetInboxRule(UpdateInboxRules):
    &#34;&#34;&#34;
    MSDN:
    https://learn.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation#updateinboxrules-set-rule-request-example
    &#34;&#34;&#34;

    def call(self, rule: Rule, remove_outlook_rule_blob: bool = True):
        payload = self.get_payload(rule=rule, remove_outlook_rule_blob=remove_outlook_rule_blob)
        return self._get_elements(payload=payload)

    def get_payload(self, rule: Rule, remove_outlook_rule_blob: bool = True):
        if not rule.id:
            raise ValueError(&#34;Rule must have an ID&#34;)
        payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
        add_xml_child(payload, &#34;m:RemoveOutlookRuleBlob&#34;, remove_outlook_rule_blob)
        operations = Operations(set_rule_operation=SetRuleOperation(rule=rule))
        set_xml_value(payload, operations, version=self.account.version)
        return payload</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.inbox_rules.UpdateInboxRules" href="#exchangelib.services.inbox_rules.UpdateInboxRules">UpdateInboxRules</a></li>
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="exchangelib.services.inbox_rules.SetInboxRule.call"><code class="name flex">
<span>def <span class="ident">call</span></span>(<span>self, rule: <a title="exchangelib.properties.Rule" href="../properties.html#exchangelib.properties.Rule">Rule</a>, remove_outlook_rule_blob: bool = True)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def call(self, rule: Rule, remove_outlook_rule_blob: bool = True):
    payload = self.get_payload(rule=rule, remove_outlook_rule_blob=remove_outlook_rule_blob)
    return self._get_elements(payload=payload)</code></pre>
</details>
</dd>
<dt id="exchangelib.services.inbox_rules.SetInboxRule.get_payload"><code class="name flex">
<span>def <span class="ident">get_payload</span></span>(<span>self, rule: <a title="exchangelib.properties.Rule" href="../properties.html#exchangelib.properties.Rule">Rule</a>, remove_outlook_rule_blob: bool = True)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_payload(self, rule: Rule, remove_outlook_rule_blob: bool = True):
    if not rule.id:
        raise ValueError(&#34;Rule must have an ID&#34;)
    payload = create_element(f&#34;m:{self.SERVICE_NAME}&#34;)
    add_xml_child(payload, &#34;m:RemoveOutlookRuleBlob&#34;, remove_outlook_rule_blob)
    operations = Operations(set_rule_operation=SetRuleOperation(rule=rule))
    set_xml_value(payload, operations, version=self.account.version)
    return payload</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.inbox_rules.UpdateInboxRules" href="#exchangelib.services.inbox_rules.UpdateInboxRules">UpdateInboxRules</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="exchangelib.services.inbox_rules.UpdateInboxRules"><code class="flex name class">
<span>class <span class="ident">UpdateInboxRules</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>MSDN: <a href="https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation">https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation</a></p>
<p>The UpdateInboxRules operation updates the authenticated user's Inbox rules by applying the specified operations.
UpdateInboxRules is used to create an Inbox rule, to set an Inbox rule, or to delete an Inbox rule.</p>
<p>When you use the UpdateInboxRules operation, Exchange Web Services deletes client-side send rules.
Client-side send rules are stored on the client in the rule Folder Associated Information (FAI) Message and nowhere
else. EWS deletes this rule FAI message by default, based on the expectation that Outlook will recreate it.
However, Outlook can't recreate rules that don't also exist as an extended rule, and client-side send rules don't
exist as extended rules. As a result, these rules are lost. We suggest you consider this when designing your
solution.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class UpdateInboxRules(EWSAccountService):
    &#34;&#34;&#34;
    MSDN: https://docs.microsoft.com/en-us/exchange/client-developer/web-service-reference/updateinboxrules-operation

    The UpdateInboxRules operation updates the authenticated user&#39;s Inbox rules by applying the specified operations.
    UpdateInboxRules is used to create an Inbox rule, to set an Inbox rule, or to delete an Inbox rule.

    When you use the UpdateInboxRules operation, Exchange Web Services deletes client-side send rules.
    Client-side send rules are stored on the client in the rule Folder Associated Information (FAI) Message and nowhere
    else. EWS deletes this rule FAI message by default, based on the expectation that Outlook will recreate it.
    However, Outlook can&#39;t recreate rules that don&#39;t also exist as an extended rule, and client-side send rules don&#39;t
    exist as extended rules. As a result, these rules are lost. We suggest you consider this when designing your
    solution.
    &#34;&#34;&#34;

    SERVICE_NAME = &#34;UpdateInboxRules&#34;
    supported_from = EXCHANGE_2010
    ERRORS_TO_CATCH_IN_RESPONSE = EWSAccountService.ERRORS_TO_CATCH_IN_RESPONSE + (ErrorInvalidOperation,)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></li>
<li><a title="exchangelib.services.common.EWSService" href="common.html#exchangelib.services.common.EWSService">EWSService</a></li>
<li><a title="exchangelib.version.SupportedVersionClassMixIn" href="../version.html#exchangelib.version.SupportedVersionClassMixIn">SupportedVersionClassMixIn</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="exchangelib.services.inbox_rules.CreateInboxRule" href="#exchangelib.services.inbox_rules.CreateInboxRule">CreateInboxRule</a></li>
<li><a title="exchangelib.services.inbox_rules.DeleteInboxRule" href="#exchangelib.services.inbox_rules.DeleteInboxRule">DeleteInboxRule</a></li>
<li><a title="exchangelib.services.inbox_rules.SetInboxRule" href="#exchangelib.services.inbox_rules.SetInboxRule">SetInboxRule</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="exchangelib.services.inbox_rules.UpdateInboxRules.ERRORS_TO_CATCH_IN_RESPONSE"><code class="name">var <span class="ident">ERRORS_TO_CATCH_IN_RESPONSE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.inbox_rules.UpdateInboxRules.SERVICE_NAME"><code class="name">var <span class="ident">SERVICE_NAME</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="exchangelib.services.inbox_rules.UpdateInboxRules.supported_from"><code class="name">var <span class="ident">supported_from</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="exchangelib.services.common.EWSAccountService" href="common.html#exchangelib.services.common.EWSAccountService">EWSAccountService</a></b></code>:
<ul class="hlist">
<li><code><a title="exchangelib.services.common.EWSAccountService.NO_VALID_SERVER_VERSIONS" href="common.html#exchangelib.services.common.EWSService.NO_VALID_SERVER_VERSIONS">NO_VALID_SERVER_VERSIONS</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.WARNINGS_TO_CATCH_IN_RESPONSE" href="common.html#exchangelib.services.common.EWSService.WARNINGS_TO_CATCH_IN_RESPONSE">WARNINGS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.get" href="common.html#exchangelib.services.common.EWSService.get">get</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.parse" href="common.html#exchangelib.services.common.EWSService.parse">parse</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.supported_api_versions" href="common.html#exchangelib.services.common.EWSService.supported_api_versions">supported_api_versions</a></code></li>
<li><code><a title="exchangelib.services.common.EWSAccountService.wrap" href="common.html#exchangelib.services.common.EWSService.wrap">wrap</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="exchangelib.services" href="index.html">exchangelib.services</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="exchangelib.services.inbox_rules.CreateInboxRule" href="#exchangelib.services.inbox_rules.CreateInboxRule">CreateInboxRule</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.inbox_rules.CreateInboxRule.call" href="#exchangelib.services.inbox_rules.CreateInboxRule.call">call</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.CreateInboxRule.get_payload" href="#exchangelib.services.inbox_rules.CreateInboxRule.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.inbox_rules.DeleteInboxRule" href="#exchangelib.services.inbox_rules.DeleteInboxRule">DeleteInboxRule</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.inbox_rules.DeleteInboxRule.call" href="#exchangelib.services.inbox_rules.DeleteInboxRule.call">call</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.DeleteInboxRule.get_payload" href="#exchangelib.services.inbox_rules.DeleteInboxRule.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.inbox_rules.GetInboxRules" href="#exchangelib.services.inbox_rules.GetInboxRules">GetInboxRules</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.inbox_rules.GetInboxRules.ERRORS_TO_CATCH_IN_RESPONSE" href="#exchangelib.services.inbox_rules.GetInboxRules.ERRORS_TO_CATCH_IN_RESPONSE">ERRORS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.GetInboxRules.SERVICE_NAME" href="#exchangelib.services.inbox_rules.GetInboxRules.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.GetInboxRules.call" href="#exchangelib.services.inbox_rules.GetInboxRules.call">call</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.GetInboxRules.element_container_name" href="#exchangelib.services.inbox_rules.GetInboxRules.element_container_name">element_container_name</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.GetInboxRules.get_payload" href="#exchangelib.services.inbox_rules.GetInboxRules.get_payload">get_payload</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.GetInboxRules.supported_from" href="#exchangelib.services.inbox_rules.GetInboxRules.supported_from">supported_from</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.inbox_rules.SetInboxRule" href="#exchangelib.services.inbox_rules.SetInboxRule">SetInboxRule</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.inbox_rules.SetInboxRule.call" href="#exchangelib.services.inbox_rules.SetInboxRule.call">call</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.SetInboxRule.get_payload" href="#exchangelib.services.inbox_rules.SetInboxRule.get_payload">get_payload</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules" href="#exchangelib.services.inbox_rules.UpdateInboxRules">UpdateInboxRules</a></code></h4>
<ul class="">
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.ERRORS_TO_CATCH_IN_RESPONSE" href="#exchangelib.services.inbox_rules.UpdateInboxRules.ERRORS_TO_CATCH_IN_RESPONSE">ERRORS_TO_CATCH_IN_RESPONSE</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.SERVICE_NAME" href="#exchangelib.services.inbox_rules.UpdateInboxRules.SERVICE_NAME">SERVICE_NAME</a></code></li>
<li><code><a title="exchangelib.services.inbox_rules.UpdateInboxRules.supported_from" href="#exchangelib.services.inbox_rules.UpdateInboxRules.supported_from">supported_from</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>
